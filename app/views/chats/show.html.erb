<div class="bg-white rounded-lg card-shadow p-6">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">ğŸ’¬ Chat ID: <%= @chat.id %></h1>

  <div class="grid md:grid-cols-2 gap-6 mb-8">
    <div class="bg-gray-50 rounded-lg p-4">
      <p class="text-lg font-semibold text-gray-800">Sender:</p>
      <p class="text-gray-700 mt-2">
        <%= link_to "#{@sender.first_name} #{@sender.last_name}", user_path(@sender),
            class: "text-blue-600 hover:text-blue-900 hover:underline" %>
        (ID: <%= @sender.id %>)
      </p>
    </div>

    <div class="bg-gray-50 rounded-lg p-4">
      <p class="text-lg font-semibold text-gray-800">Receiver:</p>
      <p class="text-gray-700 mt-2">
        <%= link_to "#{@receiver.first_name} #{@receiver.last_name}", user_path(@receiver),
            class: "text-blue-600 hover:text-blue-900 hover:underline" %>
        (ID: <%= @receiver.id %>)
      </p>
    </div>
  </div>

  <% if @chat.includes_user?(current_user) %>
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg mb-6">
      <strong>You participate in this chat</strong> - You can create messages here
    </div>
  <% end %>

  <div class="bg-gray-50 rounded-lg p-4 mb-6">
    <h2 class="text-xl font-semibold text-gray-800 mb-4"> Messages</h2>
    <% if @messages.any? %>
      <ul class="space-y-3">
        <% @messages.each do |message| %>
          <li class="bg-white p-4 rounded border border-gray-200">
            <div class="flex justify-between items-start">
              <div class="flex-1">
                <strong class="text-gray-800"><%= message.user.first_name %>:</strong>
                <div class="mt-1">
                  <%= link_to message.body, message_path(message),
                      class: "text-blue-600 hover:text-blue-900 hover:underline" %>
                </div>
              </div>
              <div class="flex space-x-2 ml-4">
                <% if can? :edit, message %>
                  <%= link_to "Edit", edit_message_path(message),
                       class: "text-blue-600 hover:text-blue-900 text-sm" %>
                <% end %>
                <% if can? :destroy, message %>
                  <%= button_to "Delete", message_path(message),
                       method: :delete,
                       data: { 
                         confirm: "Are you sure?",
                         turbo_confirm: "Are you sure?"
                       },
                       class: "text-red-600 hover:text-red-900 text-sm bg-transparent border-0 p-0" %>
                <% end %>
              </div>
            </div>
          </li>
        <% end %>
      </ul>
    <% else %>
      <p class="text-gray-500 italic">No messages in this chat yet</p>
    <% end %>
  </div>

  <div class="flex space-x-4">
    <% if can? :edit, @chat %>
      <%= link_to "Edit Chat", edit_chat_path(@chat),
          class: "btn-primary text-white px-6 py-2 rounded-lg font-medium" %>
    <% end %>

    <% if can? :destroy, @chat %>
      <%= button_to "Delete Chat", chat_path(@chat),
          method: :delete,
          data: { 
            confirm: "Are you sure you want to delete this chat? All messages will be lost.",
            turbo_confirm: "Are you sure you want to delete this chat? All messages will be lost."
          },
          class: "bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors duration-200 font-medium" %>
    <% end %>

    <%= link_to "Back", chats_path,
        class: "bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors duration-200 font-medium" %>
  </div>

  <% unless can? :edit, @chat %>
    <div class="mt-6 bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded-lg">
      <strong>Note:</strong> You can only view this chat. You don't participate in it, so you cannot edit it.
    </div>
  <% end %>
</div>